# ğŸ§¬ Evolution Cycle #0016
**Date:** 2026-02-04 23:06 CET
**Mode:** MUTATION (Fix + Optimize + Harden)
**Status:** âœ… SUCCESS

## Changes

### 1. gdrive-sync.sh â€” 3 Fixes (Critical)

**Bug Fix: Subshell Counter Bug**
- `find | while` runs in a subshell â†’ `UPLOADED`/`SKIPPED`/`ERRORS` counters never propagated back to parent
- Every sync log reported "Uploaded: 0, Skipped: 0, Errors: 0" regardless of actual activity
- **Fix:** Temp file-based counters that survive subshell boundaries

**Optimization: Folder Listing Cache**
- Previously: `gog drive ls` called per-file (N API calls per folder)
- Now: One listing per folder, cached in tmpdir, invalidated on upload
- **Impact:** ~80% fewer API calls for large folders

**Automation: Changelog Auto-Upload**
- Previously: Changelog upload was manual (done ad-hoc in session)
- Now: Automatically uploads/replaces `YYYY-MM.md` to Drive changelog folder
- **Impact:** Eliminates one manual step per sync

### 2. outreach-status.sh â€” 3 Fixes

**Bug Fix: grep -c Exit Code Handling**
- `grep -c "pattern" || echo "0"` produces "0\n0" (grep outputs 0, then echo adds another)
- **Fix:** `grep -c ... 2>/dev/null) || VAR=0` â€” proper exit code handling

**Improvement: Smart Send Counting**
- Old: Counted ALL pipe-separated table rows (including every table in the file)
- New: Specifically parses "External Sends Today" section, skips headers/separators
- Also reads explicit "Send Count: N" line as override

**Feature: Days Since Last Send Tracker**
- Scans last 14 days of tracking files
- Reports "Last send: Today âœ…", "Yesterday", or "âš ï¸ X days ago"
- Missing sends = visible accountability

## Impact Assessment
- **gdrive-sync.sh**: Every nightly sync now reports accurate stats + auto-uploads changelog
- **outreach-status.sh**: Reliable pipeline visibility for heartbeat checks
- **Combined**: Better observability â†’ better accountability â†’ closer to â‚¬500K

## Files Modified
- `scripts/gdrive-sync.sh` (v1â†’v2)
- `scripts/outreach-status.sh` (v1â†’v2)
- `logs/evolution/2026-02-04-cycle-016.md` (this file)
