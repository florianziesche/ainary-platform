<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNC Planner Pro — Vollständige Demo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* === LANDING PAGE DESIGN SYSTEM === */
        :root {
            --primary: #1e3a5f;
            --primary-dark: #0f2840;
            --primary-light: #2d5a8a;
            --accent: #2563eb;
            --accent-dark: #1d4ed8;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            --radius: 6px;
            --radius-lg: 12px;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gray-100);
            color: var(--gray-800);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .logo-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .logo-text span { color: var(--accent); }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: white;
            color: var(--gray-700);
            border-color: var(--gray-300);
        }

        .btn-secondary:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }

        .btn-accent {
            background: var(--accent);
            color: white;
        }

        .btn-accent:hover {
            background: var(--accent-dark);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.8rem;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        /* Section Header */
        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-badge {
            display: inline-block;
            background: var(--gray-100);
            color: var(--primary);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 16px;
            border: 1px solid var(--gray-200);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 12px;
        }

        .section-subtitle {
            font-size: 1.1rem;
            color: var(--gray-500);
            max-width: 600px;
            margin: 0 auto;
        }

        /* App Demo */
        .app-demo {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .app-tabs {
            display: flex;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
        }

        .app-tab {
            padding: 16px 24px;
            background: none;
            border: none;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--gray-500);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .app-tab:hover {
            color: var(--gray-700);
            background: white;
        }

        .app-tab.active {
            color: var(--primary);
            background: white;
        }

        .app-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .app-content {
            padding: 24px;
            min-height: 600px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Quote Preview */
        .quote-preview {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 32px;
        }

        .quote-header-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--primary);
        }

        .quote-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .quote-meta {
            text-align: right;
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        .quote-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 24px;
        }

        .quote-table th {
            background: var(--gray-100);
            text-align: left;
            padding: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .quote-table td {
            padding: 12px;
            border-bottom: 1px solid var(--gray-200);
        }

        .quote-table .price {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
        }

        .quote-total {
            background: var(--gray-50);
            padding: 20px;
            border-radius: var(--radius);
        }

        .quote-total-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 0.9rem;
        }

        .quote-total-row.grand {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            border-top: 2px solid var(--primary);
            margin-top: 12px;
            padding-top: 16px;
        }

        /* Calculation Section */
        .calc-section {
            background: var(--gray-50);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 20px;
        }

        .calc-section h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .calc-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .calc-table th {
            background: var(--gray-200);
            padding: 10px 12px;
            text-align: left;
            font-weight: 500;
            color: var(--gray-700);
        }

        .calc-table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--gray-200);
            background: white;
        }

        .calc-table .formula {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--primary);
            background: var(--gray-100);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .calc-table .result {
            font-weight: 600;
            color: var(--accent);
        }

        .calc-note {
            background: #eff6ff;
            border-left: 3px solid var(--primary);
            padding: 16px;
            font-size: 0.85rem;
            color: var(--gray-700);
            margin-top: 16px;
            border-radius: 0 var(--radius) var(--radius) 0;
        }

        .tool-total {
            background: var(--accent);
            color: white;
            padding: 16px 20px;
            border-radius: var(--radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 16px;
        }

        .tool-total-label { font-weight: 500; }
        .tool-total-value { font-size: 1.4rem; font-weight: 700; }

        /* Cost Summary Grid */
        .cost-summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-top: 20px;
        }

        .cost-card {
            background: rgba(255,255,255,0.15);
            padding: 20px;
            border-radius: var(--radius);
            text-align: center;
        }

        .cost-card-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .cost-card-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 4px 0;
        }

        .cost-card-detail {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        .cost-card.total {
            background: rgba(255,255,255,0.25);
        }

        .cost-card.total .cost-card-value {
            font-size: 1.8rem;
        }

        /* Code Block */
        .code-block {
            background: var(--gray-900);
            border-radius: var(--radius);
            padding: 24px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: #e2e8f0;
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }

        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
        }

        .code-comment { color: #718096; }
        .code-keyword { color: #f6ad55; }
        .code-number { color: #68d391; }
        .code-gcode { color: #90cdf4; }
        .code-mcode { color: #fc8181; }

        /* Instruction Section */
        .instruction-section {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .instruction-section.critical {
            border-color: var(--danger);
        }

        .instruction-header {
            background: var(--gray-50);
            padding: 14px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            border-bottom: 1px solid var(--gray-200);
        }

        .instruction-header.critical {
            background: #fef2f2;
        }

        .instruction-header h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--gray-800);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .op-badge {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .op-badge.critical {
            background: var(--danger);
        }

        .badge {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
        }

        .badge-critical {
            background: #fef2f2;
            color: var(--danger);
        }

        .badge-info {
            background: #eff6ff;
            color: var(--accent);
        }

        .instruction-content {
            padding: 20px;
        }

        .params-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .param-item {
            background: var(--gray-50);
            padding: 12px;
            border-radius: var(--radius);
            text-align: center;
            border: 1px solid var(--gray-200);
        }

        .param-item.critical {
            border-color: var(--danger);
        }

        .param-label {
            font-size: 0.7rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .param-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-800);
            font-family: 'JetBrains Mono', monospace;
        }

        .param-value.critical {
            color: var(--danger);
        }

        .tips-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .tips-list li {
            padding: 10px 0;
            font-size: 0.85rem;
            color: var(--gray-600);
            display: flex;
            align-items: flex-start;
            gap: 10px;
            border-bottom: 1px solid var(--gray-100);
        }

        .tips-list li:last-child {
            border-bottom: none;
        }

        .tip-icon {
            flex-shrink: 0;
            width: 20px;
            height: 20px;
            background: var(--gray-200);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: var(--gray-600);
        }

        .tip-icon.warning {
            background: #fef3c7;
            color: var(--warning);
        }

        .tip-icon.danger {
            background: #fef2f2;
            color: var(--danger);
        }

        .tip-icon.success {
            background: #ecfdf5;
            color: var(--success);
        }

        /* Warning Box */
        .warning-box {
            background: #fef9e6;
            border-left: 4px solid var(--warning);
            padding: 16px 20px;
            border-radius: 0 var(--radius) var(--radius) 0;
            margin-bottom: 24px;
        }

        .warning-box strong {
            color: #92400e;
        }

        .warning-box span {
            color: #78350f;
        }

        .danger-box {
            background: #fef2f2;
            border-left: 4px solid var(--danger);
            padding: 16px 20px;
            border-radius: 0 var(--radius) var(--radius) 0;
            margin-bottom: 16px;
        }

        .danger-box strong {
            color: var(--danger);
            font-size: 0.85rem;
        }

        /* Info Grid */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .info-table {
            font-size: 0.85rem;
            width: 100%;
        }

        .info-table td {
            padding: 6px 0;
        }

        .info-table td:first-child {
            color: var(--gray-500);
            width: 40%;
        }

        .info-table strong {
            color: var(--gray-800);
        }

        /* ROI Calculator */
        .roi-section {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 32px;
            margin-bottom: 40px;
        }

        .roi-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }

        .roi-inputs h3,
        .roi-results h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 24px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 6px;
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 1rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 95, 0.1);
        }

        .input-group .hint {
            font-size: 0.75rem;
            color: var(--gray-400);
            margin-top: 4px;
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .result-label {
            color: var(--gray-600);
        }

        .result-value {
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .result-value.positive {
            color: var(--success);
        }

        .result-value.negative {
            color: var(--gray-500);
        }

        .roi-highlight {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 24px;
            border-radius: var(--radius);
            margin-top: 24px;
            text-align: center;
        }

        .roi-highlight-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .roi-highlight-value {
            font-size: 3rem;
            font-weight: 700;
        }

        .roi-highlight-value span {
            font-size: 1.5rem;
            opacity: 0.8;
        }

        /* Quality Check Table */
        .quality-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .quality-table th {
            background: var(--gray-100);
            padding: 10px 12px;
            text-align: left;
            font-weight: 500;
        }

        .quality-table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--gray-200);
        }

        .quality-table .check {
            color: var(--success);
            font-weight: 600;
        }

        /* AI Badge */
        .ai-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* Collapsible Sections */
        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .collapsible-header:hover {
            opacity: 0.8;
        }

        .collapse-icon {
            font-size: 0.8rem;
            color: var(--gray-500);
            transition: transform 0.2s;
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .collapsible-content.expanded {
            max-height: 2000px;
        }

        .calc-detail-row {
            display: none;
            background: var(--gray-50);
        }

        .calc-detail-row.visible {
            display: table-row;
        }

        .calc-detail-cell {
            padding: 12px 16px;
            font-size: 0.8rem;
            border-left: 3px solid var(--accent);
        }

        .calc-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .calc-breakdown-item {
            background: white;
            padding: 10px;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
        }

        .calc-breakdown-label {
            font-size: 0.7rem;
            color: var(--gray-500);
            text-transform: uppercase;
        }

        .calc-breakdown-value {
            font-size: 0.9rem;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .expand-row {
            cursor: pointer;
        }

        .expand-row:hover {
            background: var(--gray-50);
        }

        .expand-icon {
            display: inline-block;
            width: 16px;
            text-align: center;
            color: var(--accent);
            font-weight: bold;
        }

        /* Project Cards */
        .projects-section {
            margin-bottom: 32px;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .project-card {
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .project-card:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-md);
        }

        .project-card.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(30, 58, 95, 0.03), rgba(37, 99, 235, 0.03));
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .project-name {
            font-weight: 600;
            color: var(--gray-900);
        }

        .project-date {
            font-size: 0.75rem;
            color: var(--gray-400);
        }

        .project-meta {
            display: flex;
            gap: 16px;
            font-size: 0.85rem;
            color: var(--gray-600);
            margin-bottom: 12px;
        }

        .project-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .project-tag {
            background: var(--gray-100);
            color: var(--gray-600);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .project-tag.success {
            background: #ecfdf5;
            color: var(--success);
        }

        /* Print Styles */
        @media print {
            body { background: white; }
            .header, .app-tabs, .btn { display: none; }
            .app-content { padding: 0; }
            .app-demo { box-shadow: none; border: none; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .roi-grid,
            .info-grid,
            .params-grid,
            .cost-summary-grid {
                grid-template-columns: 1fr;
            }
            .app-tabs { overflow-x: auto; }
        }
    </style>
</head>
<body>

<!-- Header -->
<header class="header">
    <div class="header-inner">
        <a href="#" class="logo">
            <div class="logo-icon">CP</div>
            <div class="logo-text">CNC <span>Planner</span> Pro</div>
        </a>
        <div style="display: flex; gap: 12px;">
            <button class="btn btn-secondary btn-sm" onclick="exportCSV()">CSV Export</button>
            <button class="btn btn-primary btn-sm" onclick="window.print()">PDF</button>
        </div>
    </div>
</header>

<div class="container">
    <!-- Section Header -->
    <div class="section-header">
        <span class="section-badge">Vollständige Demo</span>
        <h2 class="section-title">CNC Planner Pro in Aktion</h2>
        <p class="section-subtitle">Alle Funktionen am Beispiel: Grundplatte WCAD-15-02-2020, Werkstoff 1.4571</p>
    </div>

    <!-- ROI Calculator -->
    <div class="roi-section">
        <div class="roi-grid">
            <div class="roi-inputs">
                <h3>Ihre aktuellen Werte</h3>
                <div class="input-group">
                    <label>Angebote pro Monat</label>
                    <input type="number" id="quotesPerMonth" value="20" min="1" oninput="calculateROI()">
                    <span class="hint">Wie viele Anfragen kalkulieren Sie?</span>
                </div>
                <div class="input-group">
                    <label>Zeit pro Kalkulation (Minuten)</label>
                    <input type="number" id="timePerQuote" value="60" min="5" oninput="calculateROI()">
                    <span class="hint">Inkl. Recherche, Berechnung, Angebotserstellung</span>
                </div>
                <div class="input-group">
                    <label>Stundenlohn Kalkulation (€)</label>
                    <input type="number" id="hourlyRate" value="50" min="10" oninput="calculateROI()">
                    <span class="hint">Meister/Facharbeiter, der kalkuliert</span>
                </div>
                <div class="input-group">
                    <label>Maschinenstundensatz (€)</label>
                    <input type="number" id="machineRate" value="85" min="30" oninput="calculateROI()">
                    <span class="hint">Ihr durchschnittlicher Satz</span>
                </div>
            </div>
            <div class="roi-results">
                <h3>Ihre Ersparnis mit CNC Planner Pro</h3>
                <div class="result-row">
                    <span class="result-label">Zeitaufwand aktuell</span>
                    <span class="result-value negative" id="currentTime">20 h/Monat</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Zeitaufwand mit CNC Planner</span>
                    <span class="result-value positive" id="newTime">3,3 h/Monat</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Eingesparte Zeit</span>
                    <span class="result-value positive" id="timeSaved">16,7 h/Monat</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Wert der Ersparnis</span>
                    <span class="result-value positive" id="moneySaved">€ 835/Monat</span>
                </div>
                <div class="result-row">
                    <span class="result-label">CNC Planner Pro kostet</span>
                    <span class="result-value" id="softwareCost">€ 49/Monat</span>
                </div>
                <div class="roi-highlight">
                    <div class="roi-highlight-label">Ihr Return on Investment</div>
                    <div class="roi-highlight-value" id="roiValue">17<span>x</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Selection -->
    <div class="projects-section">
        <h3 style="font-size: 1rem; font-weight: 600; color: var(--gray-700); margin-bottom: 16px;">Beispielprojekte</h3>
        <div class="projects-grid">
            <div class="project-card active" onclick="loadProject('grundplatte')">
                <div class="project-header">
                    <div class="project-name">Grundplatte WCAD-15-02-2020</div>
                    <div class="project-date">Heute</div>
                </div>
                <div class="project-meta">
                    <span>41,8 min</span>
                    <span>1.4571</span>
                    <span>€122,07</span>
                </div>
                <div class="project-tags">
                    <span class="project-tag success">Vollständig</span>
                    <span class="project-tag">h5 Toleranz</span>
                </div>
            </div>
            <div class="project-card" onclick="loadProject('lagerbock')">
                <div class="project-header">
                    <div class="project-name">Lagerbock WZ-2024-118</div>
                    <div class="project-date">Gestern</div>
                </div>
                <div class="project-meta">
                    <span>28,5 min</span>
                    <span>42CrMo4</span>
                    <span>€85,20</span>
                </div>
                <div class="project-tags">
                    <span class="project-tag">Entwurf</span>
                </div>
            </div>
            <div class="project-card" onclick="loadProject('flansch')">
                <div class="project-header">
                    <div class="project-name">Flansch FL-889</div>
                    <div class="project-date">vor 3 Tagen</div>
                </div>
                <div class="project-meta">
                    <span>18,2 min</span>
                    <span>S355</span>
                    <span>€48,50</span>
                </div>
                <div class="project-tags">
                    <span class="project-tag success">Angebot erstellt</span>
                </div>
            </div>
        </div>
    </div>

    <!-- App Demo with Tabs -->
    <div class="app-demo">
        <div class="app-tabs">
            <button class="app-tab active" onclick="showTab('quote')">Angebot</button>
            <button class="app-tab" onclick="showTab('calculation')">Kalkulation</button>
            <button class="app-tab" onclick="showTab('code')">Maschinencode</button>
            <button class="app-tab" onclick="showTab('instructions')">Fertigungsanweisung</button>
        </div>

        <div class="app-content">
            <!-- ================ TAB: ANGEBOT ================ -->
            <div class="tab-panel active" id="panel-quote">
                <div style="display: flex; gap: 12px; margin-bottom: 24px;">
                    <button class="btn btn-primary btn-sm" onclick="window.print()">PDF drucken</button>
                    <button class="btn btn-secondary btn-sm">Per E-Mail senden</button>
                    <button class="btn btn-secondary btn-sm">Duplizieren</button>
                </div>

                <div class="quote-preview">
                    <div class="quote-header-row">
                        <div>
                            <div class="quote-title">ANGEBOT</div>
                            <div style="color: var(--gray-500); font-size: 0.85rem;">ANG-2026-0042</div>
                        </div>
                        <div class="quote-meta">
                            <div><strong>Maschinenbau Schlottwitz GmbH</strong></div>
                            <div>Datum: 02.02.2026</div>
                            <div>Gültig bis: 04.03.2026</div>
                        </div>
                    </div>

                    <table class="quote-table">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Beschreibung</th>
                                <th>Menge</th>
                                <th class="price">EP (€)</th>
                                <th class="price">GP (€)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>
                                    <strong>Grundplatte (Zahnradpumpe)</strong><br>
                                    <span style="color: var(--gray-500); font-size: 0.8rem;">WCAD-15-02-2020, Werkstoff 1.4571</span>
                                </td>
                                <td>10</td>
                                <td class="price">112,50</td>
                                <td class="price">1.125,00</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>
                                    <strong>Material — Rundstahl Ø135×50</strong><br>
                                    <span style="color: var(--gray-500); font-size: 0.8rem;">1.4571, inkl. Zuschnitt</span>
                                </td>
                                <td>10</td>
                                <td class="price">45,00</td>
                                <td class="price">450,00</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="quote-total">
                        <div class="quote-total-row">
                            <span>Zwischensumme:</span>
                            <span>1.575,00 €</span>
                        </div>
                        <div class="quote-total-row">
                            <span>Rüstkosten (einmalig):</span>
                            <span>42,50 €</span>
                        </div>
                        <div class="quote-total-row">
                            <span>Netto:</span>
                            <span>1.617,50 €</span>
                        </div>
                        <div class="quote-total-row">
                            <span>zzgl. MwSt. 19%:</span>
                            <span>307,33 €</span>
                        </div>
                        <div class="quote-total-row grand">
                            <span>GESAMTBETRAG:</span>
                            <span>1.924,83 €</span>
                        </div>
                    </div>

                    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--gray-200); font-size: 0.8rem; color: var(--gray-500);">
                        <strong>Zahlungsbedingungen:</strong> 14 Tage netto ab Rechnungsdatum<br>
                        <strong>Lieferzeit:</strong> ca. 3-4 Wochen nach Auftragseingang
                    </div>
                </div>
            </div>

            <!-- ================ TAB: KALKULATION ================ -->
            <div class="tab-panel" id="panel-calculation">
                <!-- Formel -->
                <div class="calc-section">
                    <h4>Berechnungsgrundlagen</h4>
                    <div class="calc-note">
                        <strong>Hauptzeit-Formel:</strong> t<sub>h</sub> = L / v<sub>f</sub> = L / (f × n)<br>
                        <span style="color: var(--gray-500);">t<sub>h</sub> = Hauptzeit [min] | L = Schnittweg [mm] | f = Vorschub [mm/U] | n = Drehzahl [U/min]</span>
                    </div>
                </div>

                <!-- Zeitberechnung -->
                <div class="calc-section">
                    <h4>Detaillierte Zeitberechnung</h4>
                    <p style="font-size: 0.8rem; color: var(--gray-500); margin-bottom: 16px;">Klicken Sie auf eine Zeile für detaillierte Berechnungsschritte</p>
                    <table class="calc-table" id="timeTable">
                        <thead>
                            <tr>
                                <th style="width: 30px;"></th>
                                <th>OP</th>
                                <th>Beschreibung</th>
                                <th>Formel</th>
                                <th>t_h</th>
                                <th>t_n</th>
                                <th>Gesamt</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="expand-row" onclick="toggleDetail('op10')">
                                <td><span class="expand-icon" id="icon-op10">+</span></td>
                                <td><strong>OP10</strong></td>
                                <td>Planfräsen</td>
                                <td><span class="formula">L / v_f</span></td>
                                <td>1,9</td>
                                <td>0,8</td>
                                <td class="result">2,7</td>
                            </tr>
                            <tr class="calc-detail-row" id="detail-op10">
                                <td colspan="7" class="calc-detail-cell">
                                    <div class="calc-breakdown">
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Werkzeug</div>
                                            <div class="calc-breakdown-value">T1 Planfräser Ø63</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Schnittweg L</div>
                                            <div class="calc-breakdown-value">750 mm</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Vorschub v_f</div>
                                            <div class="calc-breakdown-value">300 mm/min</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Drehzahl n</div>
                                            <div class="calc-breakdown-value">800 U/min</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Berechnung</div>
                                            <div class="calc-breakdown-value">750 / 300 = 2,5 min</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Hauptzeit t_h</div>
                                            <div class="calc-breakdown-value" style="color: var(--accent);">1,9 min</div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr class="expand-row" onclick="toggleDetail('op20')">
                                <td><span class="expand-icon" id="icon-op20">+</span></td>
                                <td><strong>OP20</strong></td>
                                <td>Schruppen Außen</td>
                                <td><span class="formula">π×D×h / v_f</span></td>
                                <td>7,2</td>
                                <td>0,8</td>
                                <td class="result">8,0</td>
                            </tr>
                            <tr class="calc-detail-row" id="detail-op20">
                                <td colspan="7" class="calc-detail-cell">
                                    <div class="calc-breakdown">
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Werkzeug</div>
                                            <div class="calc-breakdown-value">T2 VHM-Fräser Ø20</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Durchmesser D</div>
                                            <div class="calc-breakdown-value">120 mm</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Tiefe h</div>
                                            <div class="calc-breakdown-value">42 mm (14 Ebenen)</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Vorschub v_f</div>
                                            <div class="calc-breakdown-value">400 mm/min</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Berechnung</div>
                                            <div class="calc-breakdown-value">π×120×14 / 400</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Hauptzeit t_h</div>
                                            <div class="calc-breakdown-value" style="color: var(--accent);">7,2 min</div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr class="expand-row" onclick="toggleDetail('op50')">
                                <td><span class="expand-icon" id="icon-op50">+</span></td>
                                <td><strong>OP50</strong></td>
                                <td style="color: var(--warning);">Schlichten Ø120 h5</td>
                                <td><span class="formula">π×D×h / v_f</span></td>
                                <td>4,3</td>
                                <td>0,8</td>
                                <td class="result">5,1</td>
                            </tr>
                            <tr class="calc-detail-row" id="detail-op50" style="background: #fef9e6;">
                                <td colspan="7" class="calc-detail-cell" style="border-left-color: var(--warning);">
                                    <div style="background: #fef3c7; padding: 10px; border-radius: var(--radius); margin-bottom: 12px; font-size: 0.8rem;">
                                        <strong>Kritische Operation:</strong> Toleranz h5 = 0 / -0,018 mm (nur 18 µm Spielraum)
                                    </div>
                                    <div class="calc-breakdown">
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Werkzeug</div>
                                            <div class="calc-breakdown-value">T3 VHM-Schlichtfräser Ø16</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Durchmesser D</div>
                                            <div class="calc-breakdown-value">120 mm</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Tiefe h</div>
                                            <div class="calc-breakdown-value">42 mm</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Vorschub v_f</div>
                                            <div class="calc-breakdown-value">250 mm/min (reduziert)</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Berechnung</div>
                                            <div class="calc-breakdown-value">π×120×42 / 250 = 63,4 → 4,3 min</div>
                                        </div>
                                        <div class="calc-breakdown-item">
                                            <div class="calc-breakdown-label">Hauptzeit t_h</div>
                                            <div class="calc-breakdown-value" style="color: var(--warning);">4,3 min</div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP30</strong></td>
                                <td>Schruppen Innen</td>
                                <td><span class="formula">Kreistasche</span></td>
                                <td>4,0</td>
                                <td>0,8</td>
                                <td class="result">4,8</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP40</strong></td>
                                <td>Schlichten Innen</td>
                                <td><span class="formula">π×44×42 / 280</span></td>
                                <td>3,4</td>
                                <td>0,8</td>
                                <td class="result">4,2</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP60</strong></td>
                                <td>Feinbohren Ø26 H7</td>
                                <td><span class="formula">L×n / v_f</span></td>
                                <td>3,3</td>
                                <td>0,8</td>
                                <td class="result">4,1</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP70</strong></td>
                                <td>Feinbohren Ø44 H7</td>
                                <td><span class="formula">15×3 / 80</span></td>
                                <td>3,8</td>
                                <td>0,8</td>
                                <td class="result">4,6</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP80</strong></td>
                                <td>Bohren (6×M8)</td>
                                <td><span class="formula">6×Ø6,8×25</span></td>
                                <td>2,8</td>
                                <td>0,8</td>
                                <td class="result">3,6</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP90</strong></td>
                                <td>Gewinde (6×M8)</td>
                                <td><span class="formula">6×M8×20</span></td>
                                <td>2,3</td>
                                <td>0,8</td>
                                <td class="result">3,1</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><strong>OP100</strong></td>
                                <td>Entgraten</td>
                                <td><span class="formula">Pauschal</span></td>
                                <td>0,8</td>
                                <td>0,8</td>
                                <td class="result">1,6</td>
                            </tr>
                            <tr style="background: var(--gray-100); font-weight: 600;">
                                <td></td>
                                <td colspan="3" style="text-align: right;">Summe:</td>
                                <td>33,8</td>
                                <td>8,0</td>
                                <td class="result"><strong>41,8 min</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Werkzeugkosten -->
                <div class="calc-section" style="background: #fef9e6; border-left: 4px solid var(--warning);">
                    <h4>Werkzeugkosten-Kalkulation</h4>
                    <p style="font-size: 0.85rem; color: var(--gray-600); margin-bottom: 16px;">
                        Automatische Berechnung basierend auf Schnittzeit und Standzeit.
                    </p>
                    <table class="calc-table">
                        <thead>
                            <tr>
                                <th>Werkzeug</th>
                                <th>Preis</th>
                                <th>Standzeit</th>
                                <th>Einsatzzeit</th>
                                <th>Kosten/Teil</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>T1 — Planfräser Ø63 (WSP)</td>
                                <td>€45,00</td>
                                <td>60 min</td>
                                <td>1,9 min</td>
                                <td class="result">€1,43</td>
                            </tr>
                            <tr>
                                <td>T2 — VHM-Fräser Ø20</td>
                                <td>€120,00</td>
                                <td>180 min</td>
                                <td>11,2 min</td>
                                <td class="result">€7,47</td>
                            </tr>
                            <tr>
                                <td>T3 — VHM-Schlichtfräser Ø16</td>
                                <td>€95,00</td>
                                <td>120 min</td>
                                <td>7,4 min</td>
                                <td class="result">€5,86</td>
                            </tr>
                            <tr>
                                <td>T11 — Feinbohrkopf Ø26</td>
                                <td>€350,00</td>
                                <td>500 min</td>
                                <td>3,3 min</td>
                                <td class="result">€2,31</td>
                            </tr>
                            <tr>
                                <td>T12 — Feinbohrkopf Ø44</td>
                                <td>€380,00</td>
                                <td>500 min</td>
                                <td>3,8 min</td>
                                <td class="result">€2,89</td>
                            </tr>
                            <tr>
                                <td>T13 — Gewindefräser M8</td>
                                <td>€65,00</td>
                                <td>200 min</td>
                                <td>2,4 min</td>
                                <td class="result">€0,78</td>
                            </tr>
                            <tr style="background: var(--gray-100);">
                                <td colspan="4" style="text-align: right;"><strong>Summe Werkzeugkosten:</strong></td>
                                <td class="result"><strong>€20,74</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="tool-total">
                        <span class="tool-total-label">Werkzeugkosten pro Teil:</span>
                        <span class="tool-total-value">€20,74</span>
                    </div>
                    <div class="calc-note" style="margin-top: 16px; background: white;">
                        <strong>Hinweis:</strong> Bei 10 Teilen = €207,40 Werkzeugkosten. 
                        Bei hartem Werkstoff (1.4571) kann das 15-25% der Gesamtkosten sein.
                    </div>
                </div>

                <!-- Gesamtkalkulation -->
                <div class="calc-section" style="background: linear-gradient(135deg, var(--primary), var(--primary-light)); color: white;">
                    <h4 style="color: white;">Gesamtkalkulation pro Teil</h4>
                    <div class="cost-summary-grid">
                        <div class="cost-card">
                            <div class="cost-card-label">Maschinenzeit</div>
                            <div class="cost-card-value">€59,22</div>
                            <div class="cost-card-detail">41,8 min × €85/h</div>
                        </div>
                        <div class="cost-card">
                            <div class="cost-card-label">Material</div>
                            <div class="cost-card-value">€45,00</div>
                            <div class="cost-card-detail">Rohteil Ø135×50</div>
                        </div>
                        <div class="cost-card">
                            <div class="cost-card-label">Werkzeuge</div>
                            <div class="cost-card-value">€20,74</div>
                            <div class="cost-card-detail">Verschleiß anteilig</div>
                        </div>
                        <div class="cost-card total">
                            <div class="cost-card-label">GESAMT</div>
                            <div class="cost-card-value">€124,96</div>
                            <div class="cost-card-detail">Selbstkosten/Teil</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.2);">
                        <span style="opacity: 0.8;">Empfohlener Verkaufspreis (10% Marge):</span>
                        <strong style="font-size: 1.3rem; margin-left: 12px;">€137,50/Teil</strong>
                    </div>
                </div>
            </div>

            <!-- ================ TAB: MASCHINENCODE ================ -->
            <div class="tab-panel" id="panel-code">
                <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                    <button class="btn btn-secondary btn-sm active">Heidenhain TNC</button>
                    <button class="btn btn-secondary btn-sm">Siemens 840D</button>
                    <button class="btn btn-secondary btn-sm">Fanuc</button>
                    <button class="btn btn-primary btn-sm" style="margin-left: auto;" onclick="copyCode()">📋 Kopieren</button>
                    <button class="btn btn-accent btn-sm" onclick="downloadCode()">⬇️ Download .H</button>
                </div>

                <div class="code-block" id="codeBlock">
<pre><span class="code-comment">; ============================================</span>
<span class="code-comment">; CNC PLANNER PRO — Automatisch generiert</span>
<span class="code-comment">; ============================================</span>
<span class="code-comment">; Werkstück:  Grundplatte WCAD-15-02-2020</span>
<span class="code-comment">; Werkstoff:  1.4571 (X6CrNiMoTi17-12-2)</span>
<span class="code-comment">; Maschine:   FEHLMANN VERSA 943</span>
<span class="code-comment">; Steuerung:  Heidenhain TNC 640</span>
<span class="code-comment">; Erstellt:   02.02.2026 12:00</span>
<span class="code-comment">; ============================================</span>

<span class="code-keyword">BEGIN PGM</span> GRUNDPLATTE <span class="code-keyword">MM</span>

<span class="code-comment">; --- WERKZEUGLISTE ---</span>
<span class="code-comment">; T1  = Planfräser Ø63 (WSP)</span>
<span class="code-comment">; T2  = VHM-Fräser Ø20</span>
<span class="code-comment">; T3  = VHM-Schlichtfräser Ø16</span>
<span class="code-comment">; T11 = Feinbohrkopf Ø26</span>
<span class="code-comment">; T12 = Feinbohrkopf Ø44</span>
<span class="code-comment">; T13 = Gewindefräser M8</span>

<span class="code-comment">; ============================================</span>
<span class="code-comment">; OP10: PLANFRÄSEN OBERSEITE</span>
<span class="code-comment">; Berechnet: t_h = 1,9 min | t_n = 0,8 min</span>
<span class="code-comment">; ============================================</span>

<span class="code-keyword">TOOL CALL</span> <span class="code-number">1</span> Z S<span class="code-number">800</span>
<span class="code-mcode">M3</span>
<span class="code-gcode">L</span> X+<span class="code-number">0</span> Y+<span class="code-number">0</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>
<span class="code-gcode">L</span> Z+<span class="code-number">2</span> F<span class="code-number">500</span>

<span class="code-keyword">CYCL DEF</span> <span class="code-number">230</span> <span class="code-keyword">FACE MILLING</span>
  Q<span class="code-number">225</span>=+<span class="code-number">0</span>      <span class="code-comment">;START POINT 1ST AXIS</span>
  Q<span class="code-number">226</span>=+<span class="code-number">0</span>      <span class="code-comment">;START POINT 2ND AXIS</span>
  Q<span class="code-number">227</span>=+<span class="code-number">0</span>      <span class="code-comment">;MILLING DEPTH</span>
  Q<span class="code-number">218</span>=<span class="code-number">150</span>     <span class="code-comment">;FIRST SIDE LENGTH</span>
  Q<span class="code-number">219</span>=<span class="code-number">150</span>     <span class="code-comment">;SECOND SIDE LENGTH</span>
  Q<span class="code-number">202</span>=<span class="code-number">2</span>       <span class="code-comment">;INFEED DEPTH</span>
  Q<span class="code-number">207</span>=<span class="code-number">300</span>     <span class="code-comment">;MILLING FEED RATE</span>

<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>
<span class="code-mcode">M5</span>

<span class="code-comment">; ============================================</span>
<span class="code-comment">; OP20: SCHRUPPEN AUSSENKONTUR Ø120</span>
<span class="code-comment">; Berechnet: t_h = 7,2 min | t_n = 0,8 min</span>
<span class="code-comment">; ACHTUNG: Aufmaß 0,3mm für Schlichtgang!</span>
<span class="code-comment">; ============================================</span>

<span class="code-keyword">TOOL CALL</span> <span class="code-number">2</span> Z S<span class="code-number">2500</span>
<span class="code-mcode">M3</span>
<span class="code-gcode">L</span> X+<span class="code-number">0</span> Y+<span class="code-number">0</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>

<span class="code-keyword">CYCL DEF</span> <span class="code-number">25</span> <span class="code-keyword">KONTUR</span>
  Q<span class="code-number">1</span>=+<span class="code-number">120.3</span>   <span class="code-comment">;DURCHMESSER (inkl. Aufmaß)</span>
  Q<span class="code-number">2</span>=+<span class="code-number">42</span>      <span class="code-comment">;TIEFE</span>
  Q<span class="code-number">3</span>=+<span class="code-number">3</span>       <span class="code-comment">;ZUSTELLUNG</span>
  Q<span class="code-number">6</span>=<span class="code-number">400</span>      <span class="code-comment">;VORSCHUB</span>

<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>

<span class="code-comment">; ============================================</span>
<span class="code-comment">; OP50: SCHLICHTEN Ø120 h5 — KRITISCH!</span>
<span class="code-comment">; Toleranz: 0 / -0,018 mm (nur 18 µm!)</span>
<span class="code-comment">; Berechnet: t_h = 4,3 min | t_n = 0,8 min</span>
<span class="code-comment">; ============================================</span>

<span class="code-keyword">TOOL CALL</span> <span class="code-number">3</span> Z S<span class="code-number">3000</span>
<span class="code-mcode">M3</span>

<span class="code-comment">; WERKZEUG VOR BEARBEITUNG AUF VERSCHLEISS PRÜFEN!</span>
<span class="code-mcode">M0</span> <span class="code-comment">;HALT - Werkzeugkontrolle</span>

<span class="code-keyword">CYCL DEF</span> <span class="code-number">25</span> <span class="code-keyword">KONTUR SCHLICHTEN</span>
  Q<span class="code-number">1</span>=+<span class="code-number">120</span>     <span class="code-comment">;DURCHMESSER FERTIGMASS</span>
  Q<span class="code-number">2</span>=+<span class="code-number">42</span>      <span class="code-comment">;TIEFE</span>
  Q<span class="code-number">3</span>=+<span class="code-number">0.15</span>    <span class="code-comment">;ZUSTELLUNG (Schlichten)</span>
  Q<span class="code-number">6</span>=<span class="code-number">250</span>      <span class="code-comment">;VORSCHUB</span>

<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>

<span class="code-comment">; ============================================</span>
<span class="code-comment">; OP60: FEINBOHREN Ø26 H7 — KRITISCH!</span>
<span class="code-comment">; Toleranz: +0,021 / 0 mm</span>
<span class="code-comment">; ============================================</span>

<span class="code-keyword">TOOL CALL</span> <span class="code-number">11</span> Z S<span class="code-number">1200</span>
<span class="code-mcode">M3</span>
<span class="code-gcode">L</span> X+<span class="code-number">0</span> Y+<span class="code-number">0</span> Z+<span class="code-number">10</span> <span class="code-keyword">FMAX</span>

<span class="code-keyword">CYCL DEF</span> <span class="code-number">201</span> <span class="code-keyword">BORING</span>
  Q<span class="code-number">200</span>=<span class="code-number">2</span>       <span class="code-comment">;SICHERHEITSABSTAND</span>
  Q<span class="code-number">201</span>=-<span class="code-number">35</span>     <span class="code-comment">;TIEFE</span>
  Q<span class="code-number">206</span>=<span class="code-number">100</span>     <span class="code-comment">;VORSCHUB TIEFENZUSTELLUNG</span>
  Q<span class="code-number">211</span>=<span class="code-number">50</span>      <span class="code-comment">;VERWEILZEIT UNTEN</span>

<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>

<span class="code-comment">; ============================================</span>
<span class="code-comment">; OP80+90: BOHREN UND GEWINDE 6×M8</span>
<span class="code-comment">; ============================================</span>

<span class="code-keyword">TOOL CALL</span> <span class="code-number">13</span> Z S<span class="code-number">800</span>
<span class="code-mcode">M3</span>

<span class="code-keyword">CYCL DEF</span> <span class="code-number">262</span> <span class="code-keyword">THREAD MILLING</span>
  Q<span class="code-number">335</span>=<span class="code-number">26</span>      <span class="code-comment">;NOMINAL DIAMETER</span>
  Q<span class="code-number">239</span>=<span class="code-number">1.25</span>    <span class="code-comment">;PITCH</span>
  Q<span class="code-number">201</span>=-<span class="code-number">20</span>     <span class="code-comment">;THREAD DEPTH</span>

<span class="code-comment">; Bohrkreis Ø75</span>
<span class="code-gcode">L</span> X+<span class="code-number">37.5</span> Y+<span class="code-number">0</span> <span class="code-keyword">FMAX</span>
<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> X+<span class="code-number">18.75</span> Y+<span class="code-number">32.48</span> <span class="code-keyword">FMAX</span>
<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> X-<span class="code-number">18.75</span> Y+<span class="code-number">32.48</span> <span class="code-keyword">FMAX</span>
<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> X-<span class="code-number">37.5</span> Y+<span class="code-number">0</span> <span class="code-keyword">FMAX</span>
<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> X-<span class="code-number">18.75</span> Y-<span class="code-number">32.48</span> <span class="code-keyword">FMAX</span>
<span class="code-keyword">CYCL CALL</span>
<span class="code-gcode">L</span> X+<span class="code-number">18.75</span> Y-<span class="code-number">32.48</span> <span class="code-keyword">FMAX</span>
<span class="code-keyword">CYCL CALL</span>

<span class="code-gcode">L</span> Z+<span class="code-number">100</span> <span class="code-keyword">FMAX</span>
<span class="code-mcode">M5</span>
<span class="code-mcode">M30</span>
<span class="code-keyword">END PGM</span> GRUNDPLATTE <span class="code-keyword">MM</span></pre>
                </div>

                <div style="margin-top: 20px; padding: 16px; background: var(--gray-50); border-radius: var(--radius); font-size: 0.85rem;">
                    <strong>Programm-Info:</strong> 127 Zeilen | Geschätzte Laufzeit: 41,8 min | Maschine: FEHLMANN VERSA 943
                </div>
            </div>

            <!-- ================ TAB: FERTIGUNGSANWEISUNG ================ -->
            <div class="tab-panel" id="panel-instructions">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                    <div style="display: flex; gap: 12px;">
                        <button class="btn btn-primary btn-sm" onclick="window.print()">PDF drucken</button>
                        <button class="btn btn-secondary btn-sm">Per E-Mail senden</button>
                    </div>
                    <span class="ai-badge">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                        KI-generierte Anweisungen
                    </span>
                </div>

                <!-- Document Header -->
                <div style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius); padding: 24px; margin-bottom: 24px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 3px solid var(--primary);">
                        <div>
                            <h3 style="color: var(--primary); font-size: 1.4rem; font-weight: 700;">FERTIGUNGSANWEISUNG</h3>
                            <p style="color: var(--gray-500);">Grundplatte — WCAD-15-02-2020</p>
                        </div>
                        <div style="text-align: right; font-size: 0.85rem; color: var(--gray-500);">
                            <div>Freigabe: 02.02.2026</div>
                            <div>Version: 1.0</div>
                        </div>
                    </div>

                    <div class="info-grid">
                        <div>
                            <h4 style="color: var(--gray-700); font-size: 0.9rem; margin-bottom: 12px;">Werkstück</h4>
                            <table class="info-table">
                                <tr><td>Werkstoff:</td><td><strong>1.4571</strong> (X6CrNiMoTi17-12-2)</td></tr>
                                <tr><td>Rohteil:</td><td>Ø135 × 50 mm</td></tr>
                                <tr><td>Fertigmaß:</td><td>Ø120 × 42 mm</td></tr>
                                <tr><td>Gewicht:</td><td>1,903 kg</td></tr>
                            </table>
                        </div>
                        <div>
                            <h4 style="color: var(--gray-700); font-size: 0.9rem; margin-bottom: 12px;">Maschine</h4>
                            <table class="info-table">
                                <tr><td>Maschine:</td><td><strong>FEHLMANN VERSA 943</strong></td></tr>
                                <tr><td>Steuerung:</td><td>Heidenhain TNC 640</td></tr>
                                <tr><td>Programm:</td><td>GRUNDPLATTE.H</td></tr>
                                <tr><td>Bearbeitungszeit:</td><td><strong>41,8 min</strong></td></tr>
                            </table>
                        </div>
                    </div>

                    <div class="warning-box">
                        <strong>Kritische Toleranzen:</strong>
                        <span>Ø120 h5 (0/-0,018mm) • Ø26 H7 (+0,021/0) • Ø44 H7 (+0,025/0)</span>
                    </div>
                </div>

                <!-- Operations -->
                <h4 style="color: var(--gray-700); font-size: 1rem; margin-bottom: 16px;">Arbeitsschritte mit Hinweisen</h4>

                <!-- OP10 -->
                <div class="instruction-section">
                    <div class="instruction-header">
                        <h4><span class="op-badge">OP10</span> Planfräsen Oberseite</h4>
                        <span style="color: var(--gray-500); font-size: 0.85rem;">2,7 min</span>
                    </div>
                    <div class="instruction-content">
                        <div class="params-grid">
                            <div class="param-item">
                                <div class="param-label">Werkzeug</div>
                                <div class="param-value">T1 Ø63</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Drehzahl</div>
                                <div class="param-value">800</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Vorschub</div>
                                <div class="param-value">300</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Zustellung</div>
                                <div class="param-value">2 mm</div>
                            </div>
                        </div>
                        <ul class="tips-list">
                            <li><span class="tip-icon success">✓</span> Rohteil plan auf Maschinentisch spannen, Parallelität prüfen</li>
                            <li><span class="tip-icon">i</span> Fräsen im Gegenlauf für bessere Oberfläche bei 1.4571</li>
                        </ul>
                    </div>
                </div>

                <!-- OP20 -->
                <div class="instruction-section">
                    <div class="instruction-header">
                        <h4><span class="op-badge">OP20</span> Schruppen Außenkontur Ø120</h4>
                        <span style="color: var(--gray-500); font-size: 0.85rem;">8,0 min</span>
                    </div>
                    <div class="instruction-content">
                        <div class="params-grid">
                            <div class="param-item">
                                <div class="param-label">Werkzeug</div>
                                <div class="param-value">T2 Ø20</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Drehzahl</div>
                                <div class="param-value">2500</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Vorschub</div>
                                <div class="param-value">400</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Aufmaß</div>
                                <div class="param-value">0,3 mm</div>
                            </div>
                        </div>
                        <ul class="tips-list">
                            <li><span class="tip-icon">i</span> Gleichlauffräsen bei austenitischem Stahl vermeiden — Kaltverfestigung!</li>
                            <li><span class="tip-icon warning">!</span> Kühlmittel-Druck mind. 20 bar, Späne kontinuierlich entfernen</li>
                            <li><span class="tip-icon">i</span> Aufmaß 0,3 mm für Schlichtgang belassen</li>
                        </ul>
                    </div>
                </div>

                <!-- OP50 - Kritisch -->
                <div class="instruction-section critical">
                    <div class="instruction-header critical">
                        <h4>
                            <span class="op-badge critical">OP50</span>
                            Schlichten Ø120 h5
                            <span class="badge badge-critical">KRITISCH</span>
                        </h4>
                        <span style="color: var(--gray-500); font-size: 0.85rem;">5,1 min</span>
                    </div>
                    <div class="instruction-content">
                        <div class="params-grid">
                            <div class="param-item">
                                <div class="param-label">Werkzeug</div>
                                <div class="param-value">T3 Ø16</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Drehzahl</div>
                                <div class="param-value">3000</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Vorschub</div>
                                <div class="param-value">250</div>
                            </div>
                            <div class="param-item critical">
                                <div class="param-label">Toleranz</div>
                                <div class="param-value critical">h5</div>
                            </div>
                        </div>
                        <div class="danger-box">
                            <strong>Toleranz h5 = 0 / -0,018 mm — Nur 18 µm Spielraum!</strong>
                        </div>
                        <ul class="tips-list">
                            <li><span class="tip-icon danger">!</span> <strong>Werkzeug vor Bearbeitung auf Verschleiß prüfen</strong> — Standzeit bei 1.4571 reduziert</li>
                            <li><span class="tip-icon danger">!</span> Werkstück-Temperatur beachten: Ausdehnung bei 20°C Abweichung = ~2 µm</li>
                            <li><span class="tip-icon warning">!</span> Nach Schlichtgang sofort messen — nicht auskühlen lassen</li>
                            <li><span class="tip-icon">i</span> Bei Erstmuster: Zwischenmessung nach 50% der Kontur empfohlen</li>
                            <li><span class="tip-icon success">✓</span> Ziel-Rauheit: Ra 1,6 — erreichbar mit diesen Parametern</li>
                        </ul>
                    </div>
                </div>

                <!-- OP60 - Kritisch -->
                <div class="instruction-section critical">
                    <div class="instruction-header critical">
                        <h4>
                            <span class="op-badge critical">OP60</span>
                            Feinbohren Ø26 H7
                            <span class="badge badge-critical">KRITISCH</span>
                        </h4>
                        <span style="color: var(--gray-500); font-size: 0.85rem;">4,1 min</span>
                    </div>
                    <div class="instruction-content">
                        <div class="params-grid">
                            <div class="param-item">
                                <div class="param-label">Werkzeug</div>
                                <div class="param-value">T11</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Drehzahl</div>
                                <div class="param-value">1200</div>
                            </div>
                            <div class="param-item">
                                <div class="param-label">Vorschub</div>
                                <div class="param-value">100</div>
                            </div>
                            <div class="param-item critical">
                                <div class="param-label">Toleranz</div>
                                <div class="param-value critical">H7</div>
                            </div>
                        </div>
                        <ul class="tips-list">
                            <li><span class="tip-icon danger">!</span> <strong>Feinbohrkopf-Einstellung dokumentieren</strong> — reproduzierbar für Serie</li>
                            <li><span class="tip-icon warning">!</span> Bohrung vor Feinbohren auf Rundheit prüfen (max. 0,01 mm)</li>
                            <li><span class="tip-icon">i</span> Ausfahren mit reduziertem Vorschub (50 mm/min) für saubere Oberfläche</li>
                        </ul>
                    </div>
                </div>

                <!-- Quality Check -->
                <div class="instruction-section">
                    <div class="instruction-header">
                        <h4>Qualitätsprüfung nach Bearbeitung</h4>
                        <span class="badge badge-info">QS</span>
                    </div>
                    <div class="instruction-content">
                        <table class="quality-table">
                            <thead>
                                <tr>
                                    <th>Prüfmerkmal</th>
                                    <th>Soll</th>
                                    <th>Prüfmittel</th>
                                    <th>Prüfung</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ø120 h5</td>
                                    <td>120,000 / 119,982</td>
                                    <td>Mikrometer</td>
                                    <td class="check">□</td>
                                </tr>
                                <tr>
                                    <td>Ø26 H7</td>
                                    <td>26,000 / 26,021</td>
                                    <td>Innenmessschraube</td>
                                    <td class="check">□</td>
                                </tr>
                                <tr>
                                    <td>Ø44 H7</td>
                                    <td>44,000 / 44,025</td>
                                    <td>Innenmessschraube</td>
                                    <td class="check">□</td>
                                </tr>
                                <tr>
                                    <td>Höhe 42 mm</td>
                                    <td>42,0 ±0,1</td>
                                    <td>Höhenmessschieber</td>
                                    <td class="check">□</td>
                                </tr>
                                <tr>
                                    <td>Ra Oberfläche</td>
                                    <td>≤ 1,6 µm</td>
                                    <td>Rauheitsmessgerät</td>
                                    <td class="check">□</td>
                                </tr>
                                <tr>
                                    <td>Gewinde M8</td>
                                    <td>6H</td>
                                    <td>Gewindelehrdorn</td>
                                    <td class="check">□</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Troubleshooting -->
                <div class="instruction-section">
                    <div class="instruction-header">
                        <h4>Problemlösung</h4>
                        <span class="badge badge-info">Hilfe</span>
                    </div>
                    <div class="instruction-content">
                        <table class="quality-table">
                            <thead>
                                <tr>
                                    <th>Problem</th>
                                    <th>Mögliche Ursache</th>
                                    <th>Maßnahme</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ø120 zu klein</td>
                                    <td>Werkzeugverschleiß</td>
                                    <td>Korrektur erhöhen oder Werkzeug wechseln</td>
                                </tr>
                                <tr>
                                    <td>Oberfläche rau</td>
                                    <td>Vorschub zu hoch</td>
                                    <td>Vorschub auf 200 reduzieren</td>
                                </tr>
                                <tr>
                                    <td>Bohrung unrund</td>
                                    <td>Feinbohrkopf-Exzentrizität</td>
                                    <td>Kopf neu einstellen, Rundlauf prüfen</td>
                                </tr>
                                <tr>
                                    <td>Gratbildung</td>
                                    <td>Stumpfes Werkzeug</td>
                                    <td>Werkzeug wechseln, Entgratschritt hinzufügen</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<script>
    // Tab Switching
    function showTab(tabName) {
        // Hide all panels
        document.querySelectorAll('.tab-panel').forEach(panel => {
            panel.classList.remove('active');
        });
        // Remove active from all tabs
        document.querySelectorAll('.app-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        // Show selected panel
        document.getElementById('panel-' + tabName).classList.add('active');
        // Add active to clicked tab
        event.target.classList.add('active');
    }

    // ROI Calculator
    function calculateROI() {
        const quotes = parseFloat(document.getElementById('quotesPerMonth').value) || 20;
        const timePerQuote = parseFloat(document.getElementById('timePerQuote').value) || 60;
        const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 50;
        const machineRate = parseFloat(document.getElementById('machineRate').value) || 85;

        // Current time in hours
        const currentTimeH = (quotes * timePerQuote) / 60;
        // With software (85% reduction)
        const newTimeH = currentTimeH * 0.15;
        // Time saved
        const timeSavedH = currentTimeH - newTimeH;
        // Money saved
        const moneySaved = timeSavedH * hourlyRate;
        // Software cost
        const softwareCost = 49;
        // ROI
        const roi = moneySaved / softwareCost;

        // Update display
        document.getElementById('currentTime').textContent = currentTimeH.toFixed(1).replace('.', ',') + ' h/Monat';
        document.getElementById('newTime').textContent = newTimeH.toFixed(1).replace('.', ',') + ' h/Monat';
        document.getElementById('timeSaved').textContent = timeSavedH.toFixed(1).replace('.', ',') + ' h/Monat';
        document.getElementById('moneySaved').textContent = '€ ' + Math.round(moneySaved).toLocaleString('de-DE') + '/Monat';
        document.getElementById('roiValue').innerHTML = Math.round(roi) + '<span>x</span>';
    }

    // Copy Code
    function copyCode() {
        const codeText = document.getElementById('codeBlock').innerText;
        navigator.clipboard.writeText(codeText).then(() => {
            alert('Code kopiert!');
        });
    }

    // Download Code
    function downloadCode() {
        const codeText = document.getElementById('codeBlock').innerText;
        const blob = new Blob([codeText], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'GRUNDPLATTE.H';
        a.click();
        URL.revokeObjectURL(url);
    }

    // Toggle Detail Row
    function toggleDetail(opId) {
        const detailRow = document.getElementById('detail-' + opId);
        const icon = document.getElementById('icon-' + opId);
        if (detailRow.classList.contains('visible')) {
            detailRow.classList.remove('visible');
            icon.textContent = '+';
        } else {
            detailRow.classList.add('visible');
            icon.textContent = '−';
        }
    }

    // Load Project
    function loadProject(projectId) {
        document.querySelectorAll('.project-card').forEach(c => c.classList.remove('active'));
        event.currentTarget.classList.add('active');
        console.log('Loading project:', projectId);
    }

    // Export CSV
    function exportCSV() {
        const data = [
            ['OP', 'Beschreibung', 't_h (min)', 't_n (min)', 'Gesamt (min)'],
            ['OP10', 'Planfräsen', '1,9', '0,8', '2,7'],
            ['OP20', 'Schruppen Außen', '7,2', '0,8', '8,0'],
            ['OP30', 'Schruppen Innen', '4,0', '0,8', '4,8'],
            ['OP40', 'Lochkreis 8x', '3,2', '1,2', '4,4'],
            ['OP50', 'Schlichten Ø120 h5', '4,3', '0,8', '5,1'],
            ['OP60', 'Feinbohren Ø26 H7', '3,3', '0,8', '4,1'],
            ['OP70', 'Feinbohren Ø44 H7', '2,3', '0,8', '3,1'],
            ['OP80', 'Stufenfräsen', '3,1', '0,8', '3,9'],
            ['OP90', 'Gewindefräsen 4x', '2,4', '1,0', '3,4'],
            ['OP100', 'Anfasen', '1,5', '0,8', '2,3'],
            ['', 'SUMME', '33,2', '8,6', '41,8']
        ];
        const csv = data.map(row => row.join(';')).join('\n');
        const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Zeitberechnung_Grundplatte.csv';
        a.click();
        URL.revokeObjectURL(url);
    }

    // Initialize ROI
    calculateROI();
</script>

</body>
</html>
